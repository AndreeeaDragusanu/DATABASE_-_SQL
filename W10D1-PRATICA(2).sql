-- CREAZIONE DATABASE GESTIONALE
CREATE DATABASE GESTIONALE;

USE GESTIONALE;

-- CREAZIONE TABELLE PER DATABASE GESTIONALE

CREATE TABLE PRODOTTI (
    IDPRODOTTO INTEGER PRIMARY KEY,
    NOMEPRODOTTO VARCHAR(100),
    PREZZO DECIMAL(10 , 2 )
);
-- DROP TABLE PRODOTTI;

CREATE TABLE CLIENTI (
    IDCLIENTE INTEGER PRIMARY KEY,
    NOME VARCHAR(50),
    EMAIL VARCHAR(100)
);
-- DROP TABLE CLIENTI;

CREATE TABLE ORDINI (
    IDORDINE INTEGER PRIMARY KEY,
    IDPRODOTTO INTEGER,
    IDCLIENTE INTEGER,
    QUANTITA INTEGER,
    FOREIGN KEY (IDPRODOTTO)
        REFERENCES PRODOTTI (IDPRODOTTO),
    FOREIGN KEY (IDCLIENTE)
        REFERENCES CLIENTI(IDCLIENTE)
);
-- DROP TABLE ORDINI;

CREATE TABLE DETTAGLIO_ORDINI (
    IDORDINE INTEGER,
    IDPRODOTTO INTEGER,
    IDCLIENTE INTEGER,
    PREZZOTOTALE DECIMAL,
    PRIMARY KEY (IDORDINE , IDPRODOTTO , IDCLIENTE),
    FOREIGN KEY (IDORDINE)
        REFERENCES ORDINI (IDORDINE),
    FOREIGN KEY (IDPRODOTTO)
        REFERENCES PRODOTTI (IDPRODOTTO),
    FOREIGN KEY (IDCLIENTE)
        REFERENCES CLIENTI (IDCLIENTE)
);
-- DROP TABLE DETTAGLIO_ORDINI;

-- INSERIMENTO DATI NELLE TABELLE

INSERT INTO PRODOTTI VALUES
(1, 'Tablet', 300.00),
(2, 'Mouse', 20.00),
(3, 'Tastiera', 25.00),
(4, 'Monitor', 180.00),
(5, 'HHD', 90.00),
(6, 'SSD', 200.00),
(7, 'RAM', 100.00),
(8, 'Router', 80.00),
(9, 'Webcam', 45.00),
(10, 'GPU', 1250.00),
(11, 'Trackpad', 500.00),
(12, 'Techmagazine', 5.00),
(13, 'Martech', 50.00);

 SELECT* FROM PRODOTTI; 

INSERT INTO CLIENTI VALUES(1, 'Antonio', ''),
(2, 'Battista', 'battista@mailmail.it'),
(3, 'Maria', 'maria@posta.it'),
(4, 'Franca', 'franca@lettere.it'),
(5, 'Ettore', ''),
(6, 'Arianna', 'arianna@posta.it'),
(7, 'Piero', 'piero@lavoro.it');
SELECT * FROM CLIENTI;

INSERT INTO ORDINI VALUES(1, 2, 1, 10),
(2, 6, 2, 2),
(3, 4, 3, 5),
(4, 9, 1, 1),
(5, 11, 6, 4),
(6, 10, 2, 2),
(7, 3, 3, 3),
(8, 1, 4, 1),
(9, 2, 5, 3),
(10, 1, 6, 2),
(11, 2, 7, 1); 
SELECT * FROM ORDINI;

INSERT INTO DETTAGLIO_ORDINI(IDORDINE, IDPRODOTTO, IDCLIENTE, PREZZOTOTALE) 
SELECT 
ORDINI.IDORDINE, 
ORDINI.IDPRODOTTO, 
ORDINI.IDCLIENTE, 
PRODOTTI.PREZZO * ORDINI.QUANTITA AS PREZZOTOTALE 
FROM ORDINI JOIN PRODOTTI ON ORDINI.IDPRODOTTO=PRODOTTI.IDPRODOTTO;

SELECT * FROM DETTAGLIO_ORDINI; 
 






